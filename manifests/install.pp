class ostack_controller::install (
     $dbtype                = 'mysql',
     $dbhost                = 'ostackdb',
     $keystonedbname        = 'keystone',
     $keystonedbuser        = 'keystone',
     $keystonedbpass        = 'keatomos3',
     $keystonedbhost        = $dbhost,
     $glancedbname          = 'glance',
     $glancedbuser          = 'glance',
     $glancedbpass          = 'glatomos3',
     $glancedbhost          = $dbhost,
     $novadbname            = 'nova',
     $novaapidbname         = 'nova_api',
     $novadbuser            = 'nova',
     $novadbpass            = 'noatomos3',
     $novadbhost            = $dbhost,
     $neutrondbname         = 'neutron',
     $neutrondbuser         = 'neutron',
     $neutrondbpass         = 'neatomos3',
     $neutrondbhost         = $dbhost,
     $glanceuser            = $glancedbuser,
     $glancepass            = $glancedbpass,
     $novauser              = $novadbuser,
     $novapass              = 'noatomos3',
     $placemuser            = 'placement',
     $placempass            = 'platomos3',
     $neutronuser           = $neutrondbuser,
     $neutronpass           = $neutrondbpass,
     $admindbpass           = 'keatomos3',
     $metadatapass          = 'meatomos3',
     $memcache_host         = 'memcache',
     $controller_host       = 'controller',
     $mq_proto              = 'rabbit',
     $mq_user               = 'openstack',
     $mq_pass               = 'raatomos3',
     $mq_host               = 'rabbitmq',
     $ostack_region         = 'RegionOne',
     $bstp_adm_port         = '35357/v3/',
     $bstp_int_port         = '5000/v3/',
     $bstp_pub_port         = '5000/v3/',
     $nova_adm_port         = '8774/v2.1',
     $nova_int_port         = '8774/v2.1',
     $nova_pub_port         = '8774/v2.1',
     $placem_adm_port       = '8778',
     $placem_int_port       = '8778',
     $placem_pub_port       = '8778',
     $glance_adm_port       = '9292',
     $glance_int_port       = '9292',
     $glance_pub_port       = '9292',
     $neutron_adm_port      = '9696',
     $neutron_int_port      = '9696',
     $neutron_pub_port      = '9696',
     $memcache_port         = '11211',
     $service_proj_descr    = "Service Project",
     $glance_service_descr  = "OpenStack Image",
     $nova_service_descr    = "OpenStack Compute",
     $placem_service_descr  = "Placement API",
     $neutron_service_descr = "OpenStack Networking",
) {
######
   # Definition of databases by the controller host which is also DB administrator
   # keystone identity service
   ostack_controller::install::keystone { 'keystone':
     dbtype             => $dbtype,
     dbname             => $keystonedbname,
     dbuser             => $keystonedbuser,
     dbpass             => $keystonedbpass,
     dbhost             => $keystonedbhost,
     controller_host    => $controller_host,
     memcache_host      => $memcache_host,
     admindbpass        => $admindbpass,
     ostack_region      => $ostack_region,
     bstp_adm_port      => $bstp_adm_port,
     bstp_int_port      => $bstp_int_port,
     bstp_pub_port      => $bstp_pub_port,
     service_proj_descr => $service_proj_descr,
     demo_create        => true,
     demo_prj_name      => $demo_prj_name,
     demo_proj_descr    => $demo_proj_descr,
     demo_user          => $demo_user,
     demo_pass	        => $demo_pass,
     before  => Ostack_controller::Install::Glance['glance'],
   }

   # glance image service (note admin pass = keystone identity service)
   ostack_controller::install::glance { 'glance':
     dbtype          => $dbtype,
     dbname          => $glancedbname,
     dbuser          => $glancedbuser,
     dbpass          => $glancedbpass,
     dbhost          => $glancedbhost,
     glanceuser      => $glanceuser,
     glancepass      => $glancepass,
     admindbpass     => $admindbpass,
     memcache_host   => $memcache_host,
     controller_host => $controller_host,
     ostack_region   => $ostack_region,
     bstp_adm_port   => $bstp_adm_port,
     bstp_int_port   => $bstp_int_port,
     bstp_pub_port   => $bstp_pub_port,
     glance_adm_port => $glance_adm_port,
     glance_int_port => $glance_int_port,
     glance_pub_port => $glance_pub_port,
     memcache_port   => $memcache_port,
     service_descr   => $service_descr,
     before          => Ostack_controller::Install::Nova['nova'],
   }
   # nova compute service (note admin pass = keystone identity service)
   ostack_controller::install::nova { 'nova':
     dbtype               => $dbtype,
     dbname               => $novadbname,
     apidbname            => $novaapidbname,
     dbuser               => $novadbuser,
     dbpass               => $novadbpass,
     dbhost               => $novadbhost,
     novauser             => $novauser,
     novapass             => $novapass,
     placemuser           => $placemuser,
     placempass           => $placempass,
     neutronuser          => $neutronuser,
     neutronpass          => $neutronpass,
     admindbpass          => $admindbpass,
     memcache_host        => $memcache_host,
     metadatapass         => $metadatapass,
     controller_host      => $controller_host,
     mq_proto             => $mq_proto,
     mq_user              => $mq_user,
     mq_pass              => $mq_pass,
     mq_host              => $mq_host,
     ostack_region        => $ostack_region,
     bstp_adm_port        => $bstp_adm_port,
     bstp_int_port        => $bstp_int_port,
     bstp_pub_port        => $bstp_pub_port,
     nova_adm_port        => $nova_adm_port,
     nova_int_port        => $nova_int_port,
     nova_pub_port        => $nova_pub_port,
     placem_adm_port      => $placem_adm_port,
     placem_int_port      => $placem_int_port,
     placem_pub_port      => $placem_pub_port,
     glance_adm_port      => $glance_adm_port,
     glance_int_port      => $glance_int_port,
     glance_pub_port      => $glance_pub_port,
     neutron_adm_port     => $neutron_adm_port,
     neutron_int_port     => $neutron_int_port,
     neutron_pub_port     => $neutron_pub_port,
     memcache_port        => $memcache_port,
     service_descr        => $service_descr,
     placem_service_descr => $placem_service_descr,
     before               => Ostack_controller::Install::Neutron['neutron'],
   }
   # neutron network service (note admin pass = keystone identity service)
   ostack_controller::install::neutron { 'neutron':
     dbtype           => $dbtype,
     dbname           => $neutrondbname,
     dbuser           => $neutrondbuser,
     dbpass           => $neutrondbpass,
     dbhost           => $neutrondbhost,
     neutronuser      => $neutronuser,
     neutronpass      => $neutronpass,
     glanceuser       => $glanceuser,
     glancepass       => $glancepass,
     novauser         => $novauser,
     novapass         => $novapass,
     admindbpass      => $admindbpass,
     metadatapass     => $metadatapass,
     memcache_host    => $memcache_host,
     controller_host  => $controller_host,
     mq_proto         => $mq_proto,
     mq_user          => $mq_user,
     mq_pass          => $mq_pass,
     mq_host          => $mq_host,
     ostack_region    => $ostack_region,
     bstp_adm_port    => $bstp_adm_port,
     bstp_int_port    => $bstp_int_port,
     bstp_pub_port    => $bstp_pub_port,
     nova_adm_port    => $nova_adm_port,
     nova_int_port    => $nova_int_port,
     nova_pub_port    => $nova_pub_port,
     placem_adm_port  => $placem_adm_port,
     placem_int_port  => $placem_int_port,
     placem_pub_port  => $placem_pub_port,
     glance_adm_port  => $glance_adm_port,
     glance_int_port  => $glance_int_port,
     glance_pub_port  => $glance_pub_port,
     neutron_adm_port => $neutron_adm_port,
     neutron_int_port => $neutron_int_port,
     neutron_pub_port => $neutron_pub_port,
     memcache_port    => $memcache_port,
     service_descr    => $service_descr,
   }
}
